(function(e){function t(t){for(var n,s,r=t[0],l=t[1],c=t[2],d=0,p=[];d<r.length;d++)s=r[d],Object.prototype.hasOwnProperty.call(o,s)&&o[s]&&p.push(o[s][0]),o[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);u&&u(t);while(p.length)p.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==o[l]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=a[0]))}return e}var n={},o={app:0},i=[];function s(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,s),a.l=!0,a.exports}s.m=e,s.c=n,s.d=function(e,t,a){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(s.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(a,n,function(t){return e[t]}.bind(null,n));return a},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var u=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"12b1":function(e,t,a){},"17a2":function(e,t,a){"use strict";a("b183")},4724:function(e,t,a){"use strict";a("a22c")},"4be5":function(e,t,a){"use strict";a("cd6d")},"4f73":function(e,t,a){},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("router-view")],1)},i=[],s={name:"App",data:function(){return{}}},r=s,l=a("2877"),c=Object(l["a"])(r,o,i,!1,null,null,null),u=c.exports,d=a("8c4f"),p=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"login-container"},[a("div",{staticClass:"login-warp"},[a("el-form",{ref:"login-form",attrs:{model:e.user,rules:e.formRules}},[a("h2",[e._v("欢迎登录")]),a("el-form-item",{attrs:{prop:"mobile"}},[a("el-input",{attrs:{placeholder:"请输入账号"},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}})],1),a("el-form-item",{attrs:{prop:"code"}},[a("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}})],1),a("el-form-item",{attrs:{prop:"agree"}},[a("el-checkbox",{model:{value:e.user.agree,callback:function(t){e.$set(e.user,"agree",t)},expression:"user.agree"}},[e._v("我已阅读并同意用户协议和隐私条款")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.isLoading},on:{click:e.onLogin}},[e._v("登录")])],1)],1)],1)])},m=[],f=(a("d3b7"),a("bc3a")),h=a.n(f),g=a("d604"),b=a.n(g),v=a("5c96"),_=a.n(v),w=h.a.create({baseURL:"http://api-toutiao-web.itheima.net",transformResponse:[function(e){try{return b.a.parse(e)}catch(t){return e}}]});h.a.create({baseURL:"https://gitee.com/api/v5/repos/"});w.interceptors.request.use((function(e){var t=JSON.parse(window.localStorage.getItem("user"));return t&&(e.headers.Authorization="Bearer ".concat(t.token)),e}),(function(e){return Promise.reject(e)})),w.interceptors.response.use((function(e){return e}),(function(e){var t=e.response.status;return console.log("状态码异常"),e.response&&401===t?(window.localStorage.removeItem("user"),rt.push("/login"),Object(v["Message"])("登录状态无效，请重新登录")):403===t?Object(v["Message"])("没有操作权限"):400===t?Object(v["Message"])("参数错误，请检查请求参数"):t>=500&&Object(v["Message"])("服务端内部异常，请稍后重试"),Promise.reject(e)}));var y=function(e){return w({method:"POST",url:"/mp/v1_0/authorizations",data:e})},C=function(){return w({method:"GET",url:"/mp/v1_0/user/profile"})},x=function(e){return w({method:"PATCH",url:"/mp/v1_0/user/photo",data:e})},S=function(e){return w({method:"PATCH",url:"/mp/v1_0/user/profile",data:e})},$=function(e,t){return w({method:"GET",url:"/mp/v1_0/followers",params:{page:e,per_page:t}})},k={name:"LoginIndex",data:function(){return{user:{mobile:"13911111111",code:"246810",agree:!1},formRules:{mobile:[{required:!0,message:"请输入账户",trigger:"blur"}],code:[{required:!0,message:"请输入密码",trigger:"blur"}],agree:[{validator:function(e,t,a){t?a():a(new Error("请同意用户协议"))}}]},isLoading:!1}},methods:{onLogin:function(){var e=this;this.$refs["login-form"].validate((function(t){if(!t)return!1;e.login()}))},login:function(){var e=this;this.isLoading=!0,y(this.user).then((function(t){e.$message.success("登录成功"),window.localStorage.setItem("user",JSON.stringify(t.data.data)),e.$router.push({name:"home"}),e.isLoading=!1})).catch((function(t){console.log(t),e.$message.error("登录失败"),e.isLoading=!1}))}}},O=k,I=(a("aabf"),Object(l["a"])(O,p,m,!1,null,"cf11a1f0",null)),z=I.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home-container"},[a("div",{ref:"main",staticStyle:{width:"600px",height:"400px",top:"50%",transform:"translateY(-55%)",left:"40px"}}),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.flag,expression:"!flag"}],staticClass:"loading"},[a("span",[e._v("数据加载中")]),a("el-image",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{height:"100%"}})],1)])},j=[],D=(a("b0c0"),function(e){return w({method:"GET",url:"/mp/v1_0/articles",params:e})}),U=function(){return w({method:"GET",url:"/mp/v1_0/channels"})},L=function(e){return w({method:"DELETE",url:"/mp/v1_0/articles/".concat(e)})},E=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return w({method:"POST",url:"/mp/v1_0/articles",params:{draft:t},data:e})},A=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return w({method:"PUT",url:"/mp/v1_0/articles/".concat(e),params:{draft:a},data:t})},T=function(e){return w({method:"GET",url:"/mp/v1_0/articles/".concat(e)})},R=function(e,t){return w({method:"PUT",url:"/mp/v1_0/comments/status",params:{article_id:e},data:{allow_comment:t}})},V=a("313e"),N=a.n(V),q={name:"HomeIndex",components:{},props:{},data:function(){return{channels:[],flag:!1,loading:!0}},computed:{},watch:{},created:function(){this.loadChannels()},mounted:function(){var e=this,t=setInterval((function(){if(e.flag){var a=N.a.init(e.$refs.main),n=e.genData(e.channels.length),o={title:{text:"各频道文章统计",subtext:"",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{type:"scroll",orient:"vertical",right:10,top:20,bottom:20,data:n.legendData,selected:n.selected},series:[{name:"频道",type:"pie",radius:"55%",center:["40%","50%"],data:n.seriesData,emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};a.setOption(o),clearInterval(t)}}),250)},methods:{loadChannels:function(){var e=this;U().then((function(t){e.channels=t.data.data.channels,e.loadChannelsCount()}))},loadChannelsCount:function(){for(var e=this,t=function(t){D({channel_id:e.channels[t].id}).then((function(a){e.channels[t].totalCount=a.data.data["total_count"]})).then((function(){t===e.channels.length-1&&(e.flag=!0)}))},a=0;a<this.channels.length;a++)t(a)},genData:function(e){for(var t=[],a=[],n={},o=0;o<e;o++){var i=this.channels[o].name,s=this.channels[o].totalCount;t.push(i),a.push({name:i,value:s}),n[i]=o<e}return{legendData:t,seriesData:a,selected:n}}}},M=q,B=(a("4be5"),Object(l["a"])(M,P,j,!1,null,"e3cb0e22",null)),F=B.exports,G=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-container",{staticClass:"layout-container"},[a("el-aside",{staticClass:"aside",attrs:{width:e.asideWidth}},[a("app-aside",{staticClass:"aside-menu",attrs:{isCollapse:e.isCollapse}})],1),a("el-container",[a("el-header",{staticClass:"header"},[a("div",[a("i",{staticClass:"pointer",class:{"el-icon-s-unfold":e.isCollapse,"el-icon-s-fold":!e.isCollapse},on:{click:e.zhedie}}),e._v(" 个人练习项目~ ")]),a("el-dropdown",[a("div",{staticClass:"avatar-wrap"},[a("img",{attrs:{src:e.userInfo.photo,alt:"头像"}}),a("span",[e._v(e._s(e.userInfo.name))]),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{nativeOn:{click:function(t){return e.onSettings.apply(null,arguments)}}},[e._v("设置")]),a("el-dropdown-item",{nativeOn:{click:function(t){return e.onLogout.apply(null,arguments)}}},[e._v("退出")])],1)],1)],1),a("el-main",{staticClass:"main"},[a("router-view")],1)],1)],1)},J=[],H=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-menu",{staticClass:"nav-menu",attrs:{"default-active":e.$route.path,"background-color":"#002033","text-color":"#fff","active-text-color":"#ffd04b",router:"",collapse:e.isCollapse}},[a("h1",[e._v("后台管理")]),a("el-menu-item",{attrs:{index:"/"}},[a("i",{staticClass:"el-icon-s-home"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("首页")])]),a("el-menu-item",{attrs:{index:"/article"}},[a("i",{staticClass:"el-icon-document"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("内容管理")])]),a("el-menu-item",{attrs:{index:"/image"}},[a("i",{staticClass:"el-icon-picture-outline"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("素材管理")])]),a("el-menu-item",{attrs:{index:"/publish"}},[a("i",{staticClass:"el-icon-s-promotion"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("发布文章")])]),a("el-menu-item",{attrs:{index:"/comment"}},[a("i",{staticClass:"el-icon-chat-dot-round"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("评论管理")])]),a("el-menu-item",{attrs:{index:"/fans"}},[a("i",{staticClass:"el-icon-pie-chart"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("粉丝管理")])]),a("el-menu-item",{attrs:{index:"/settings"}},[a("i",{staticClass:"el-icon-setting"}),a("span",{attrs:{slot:"title"},slot:"title"},[e._v("个人设置")])])],1)},W=[],X={name:"Aside",components:{},props:["isCollapse"],data:function(){return{}},computed:{},watch:{},created:function(){},mounted:function(){},methods:{}},Y=X,K=(a("8fb9"),Object(l["a"])(Y,H,W,!1,null,"d02ba696",null)),Q=K.exports,Z={name:"LayoutIndex",components:{appAside:Q},props:{},data:function(){return{userInfo:{photo:a("c6eb"),name:"007"},isCollapse:!1}},computed:{asideWidth:function(){return this.isCollapse?"auto":"200px"}},watch:{},created:function(){this.loadUserPrifile()},mounted:function(){var e=this;this.$bus.$on("updateUser",(function(t){var a=t.name,n=t.photo;e.userInfo.name=a,e.userInfo.photo=n}))},beforeDestroy:function(){this.$bus.$off("updateUser")},methods:{loadUserPrifile:function(){var e=this;C().then((function(t){e.userInfo.name=t.data.data.name,e.userInfo.photo=t.data.data.photo}))},zhedie:function(){this.isCollapse=!this.isCollapse},onLogout:function(){var e=this;this.$confirm("是否登出账号?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){window.localStorage.removeItem("user"),e.$router.push("/login"),e.$message({type:"success",message:"登出成功!"})})).catch((function(){e.$message({type:"info",message:"已取消登出"})}))},onSettings:function(){this.$router.push("/settings")}}},ee=Z,te=(a("63d6"),Object(l["a"])(ee,G,J,!1,null,"3f1f2af3",null)),ae=te.exports,ne=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"article-container"},[a("el-card",{staticClass:"box-card",attrs:{"body-style":{padding:"15px"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("内容管理")])],1)],1),a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"50px"}},[a("el-form-item",{attrs:{label:"状态"}},[a("el-radio-group",{model:{value:e.status,callback:function(t){e.status=t},expression:"status"}},[a("el-radio",{attrs:{label:null}},[e._v("全部")]),a("el-radio",{attrs:{label:0}},[e._v("草稿")]),a("el-radio",{attrs:{label:1}},[e._v("待审核")]),a("el-radio",{attrs:{label:2}},[e._v("审核通过")]),a("el-radio",{attrs:{label:3}},[e._v("审核失败")]),a("el-radio",{attrs:{label:4}},[e._v("已删除")])],1)],1),a("el-form-item",{attrs:{label:"频道"}},[a("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.channelId,callback:function(t){e.channelId=t},expression:"channelId"}},[a("el-option",{attrs:{label:"全部",value:null}}),e._l(e.channels,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}))],2)],1),a("el-form-item",{attrs:{label:"日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","start-placeholder":"开始日期","end-placeholder":"结束日期","default-time":["12:00:00"],format:"yyyy-MM-dd","value-format":"yyyy-MM-dd"},model:{value:e.rangeDate,callback:function(t){e.rangeDate=t},expression:"rangeDate"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.loadArticles(1)}}},[e._v("查询")])],1)],1)],1),a("el-card",{staticClass:"box-card data-box",attrs:{"body-style":{padding:"15px"}}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e._v(" 根据筛选条件共查询到 "+e._s(e.totalCount)+" 条结果： ")]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:e.articles,stripe:""}},[a("el-table-column",{attrs:{label:"封面"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("el-image",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.row.cover.images[0],fit:"cover",lazy:"","preview-src-list":e.row.cover.images}})]}}])}),a("el-table-column",{attrs:{prop:"title",label:"标题"}}),a("el-table-column",{attrs:{label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:e.articleStatus[t.row.status].type}},[e._v(" "+e._s(e.articleStatus[t.row.status].text)+" ")])]}}])}),a("el-table-column",{attrs:{prop:"pubdate",label:"发布时间"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{size:"mini",type:"primary",circle:"",icon:"el-icon-edit"},on:{click:function(a){return e.$router.push("/publish?id="+t.row.id)}}}),a("el-button",{attrs:{size:"mini",type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.onDeleteArticle(t.row.id)}}})]}}])})],1),a("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next",total:e.totalCount,"page-size":e.pageSize,disabled:e.loading,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.loadArticles}})],1)],1)},oe=[],ie=(a("25f0"),{name:"ArticleIndex",components:{},props:{},data:function(){return{form:{name:"",region:"",date1:"",date2:"",delivery:!1,type:[],resource:"",desc:""},articles:[],articleStatus:[{status:0,text:"草稿",type:"info"},{status:1,text:"待审核",type:""},{status:2,text:"审核通过",type:"success"},{status:3,text:"审核失败",type:"warning"},{status:4,text:"已删除",type:"danger"}],totalCount:0,pageSize:10,status:null,channels:[],channelId:null,rangeDate:null,loading:!0,page:1}},computed:{},watch:{},created:function(){this.loadArticles(1),this.loadChannels()},mounted:function(){},methods:{loadArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.loading=!0,D({page:t,per_page:this.pageSize,status:this.status,channel_id:this.channelId,begin_pubdate:this.rangeDate?this.rangeDate[0]:null,end_pubdate:this.rangeDate?this.rangeDate[1]:null}).then((function(t){var a=t.data.data,n=a.results,o=a.total_count;e.articles=n,e.totalCount=o,e.loading=!1}))},loadChannels:function(){var e=this;U().then((function(t){e.channels=t.data.data.channels}))},onDeleteArticle:function(e){var t=this;console.log(e),console.log(e.toString()),this.$confirm("确认删除吗？","删除提示",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((function(){L(e.toString()).then((function(e){t.$message.success("删除成功")}))})).catch((function(){t.$message.info("已取消删除")}))}}}),se=ie,re=(a("4724"),Object(l["a"])(se,ne,oe,!1,null,"1fab143a",null)),le=re.exports,ce=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"publish-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v(e._s(e.$route.query.id?"修改文章":"发布文章"))])],1)],1),a("el-form",{ref:"publish-form",attrs:{model:e.article,rules:e.formRules,"label-width":"60px"}},[a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入文章标题"},model:{value:e.article.title,callback:function(t){e.$set(e.article,"title",t)},expression:"article.title"}})],1),a("el-form-item",{attrs:{label:"内容",prop:"content"}},[a("el-tiptap",{attrs:{extensions:e.extensions,height:"400px",placeholder:"请输入文章内容"},model:{value:e.article.content,callback:function(t){e.$set(e.article,"content",t)},expression:"article.content"}})],1),a("el-form-item",{attrs:{label:"封面"}},[a("el-radio-group",{model:{value:e.article.cover.type,callback:function(t){e.$set(e.article.cover,"type",t)},expression:"article.cover.type"}},[a("el-radio",{attrs:{label:1}},[e._v("单图")]),a("el-radio",{attrs:{label:3}},[e._v("三图")]),a("el-radio",{attrs:{label:0}},[e._v("无图")]),a("el-radio",{attrs:{label:-1}},[e._v("自动")])],1),e.article.cover.type>0?e._l(e.article.cover.type,(function(t,n){return a("upload-cover",{key:t,model:{value:e.article.cover.images[n],callback:function(t){e.$set(e.article.cover.images,n,t)},expression:"article.cover.images[index]"}})})):e._e()],2),a("el-form-item",{attrs:{label:"频道",prop:"channel_id"}},[a("el-select",{attrs:{placeholder:"请选择频道"},model:{value:e.article.channel_id,callback:function(t){e.$set(e.article,"channel_id",t)},expression:"article.channel_id"}},e._l(e.channels,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.onPublish(!1)}}},[e._v("发表")]),a("el-button",{on:{click:function(t){return e.onPublish(!0)}}},[e._v("存入草稿")])],1)],1)],1)],1)},ue=[],de=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-cover"},[a("div",{staticClass:"cover-wrap",on:{click:e.showCoverSelect}},[a("img",{ref:"cover-image",staticClass:"cover-image",attrs:{src:e.value}})]),a("el-dialog",{attrs:{title:"选择封面",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-tabs",{attrs:{type:"card"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"素材库",name:"first"}},[a("image-list",{ref:"image-list",attrs:{"is-show-add":!1,"is-show-action":!1,"is-show-selected":""}})],1),a("el-tab-pane",{attrs:{label:"上传图片",name:"second"}},[a("input",{ref:"file",attrs:{type:"file"},on:{change:e.onFileChange}}),a("img",{ref:"preview-image",attrs:{width:"150"}})])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.onCoverConfirm}},[e._v("确 定")])],1)],1)],1)},pe=[],me=(a("3ca3"),a("ddb0"),a("2b3d"),function(e){return w({method:"POST",url:"/mp/v1_0/user/images",data:e})}),fe=function(e){return w({method:"GET",url:"/mp/v1_0/user/images",params:e})},he=function(e,t){return w({method:"PUT",url:"/mp/v1_0/user/images/".concat(e),data:{collect:t}})},ge=function(e){return w({method:"DELETE",url:"/mp/v1_0/user/images/".concat(e)})},be=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-list"},[a("div",{staticClass:"action-head"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.onCollectChange},model:{value:e.collect,callback:function(t){e.collect=t},expression:"collect"}},[a("el-radio-button",{attrs:{label:!1}},[e._v("全部")]),a("el-radio-button",{attrs:{label:!0}},[e._v("收藏")])],1),e.isShowAdd?a("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){e.dialogUploadVisible=!0}}},[e._v("上传素材")]):e._e()],1),a("el-row",{attrs:{gutter:10}},e._l(e.images,(function(t,n){return a("el-col",{key:t.id,staticClass:"image-item",attrs:{xs:12,sm:8,md:6,lg:4},nativeOn:{click:function(t){e.selected=n}}},[a("el-image",{staticStyle:{height:"100px",position:"relative"},attrs:{src:t.url,fit:"cover"}}),e.isShowSelected&&e.selected===n?a("div",{staticClass:"selected"}):e._e(),e.isShowAction?a("div",{staticClass:"image-action"},[a("el-button",{attrs:{type:"warning",circle:"",size:"mini",icon:t.is_collected?"el-icon-star-on":"el-icon-star-off",loading:t.loading},on:{click:function(a){return e.onCollect(t)}}}),a("el-button",{attrs:{type:"danger",circle:"",size:"mini",icon:"el-icon-delete-solid",loading:t.loading},on:{click:function(a){return e.onDelete(t)}}})],1):e._e()],1)})),1),a("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"prev, pager, next",total:e.totalCount,"page-size":e.pageSize,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.onPageChange}}),a("el-dialog",{attrs:{title:"上传素材",visible:e.dialogUploadVisible,"append-to-body":!0},on:{"update:visible":function(t){e.dialogUploadVisible=t}}},[a("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"http://api-toutiao-web.itheima.net/mp/v1_0/user/images",headers:e.uploadHeaders,name:"image",multiple:"","show-file-list":!1,"on-success":e.onUploadSuccess}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])])],1)],1)},ve=[],_e=a("b85c"),we={name:"ImageList",components:{},props:{isShowAdd:{type:Boolean,default:!0},isShowAction:{type:Boolean,default:!0},isShowSelected:{type:Boolean,default:!1}},data:function(){var e=JSON.parse(window.localStorage.getItem("user"));return{collect:!1,images:[],dialogUploadVisible:!1,uploadHeaders:{Authorization:"Bearer ".concat(e.token)},totalCount:0,pageSize:12,page:1,selected:null}},computed:{},watch:{},created:function(){this.loadImages()},mounted:function(){},methods:{loadImages:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,fe({collect:this.collect,page:t,per_page:this.pageSize}).then((function(t){var a,n=t.data.data.results,o=Object(_e["a"])(n);try{for(o.s();!(a=o.n()).done;){var i=a.value;i.loading=!1}}catch(s){o.e(s)}finally{o.f()}e.images=n,e.totalCount=t.data.data.total_count}))},onCollectChange:function(){this.loadImages()},onUploadSuccess:function(){this.dialogUploadVisible=!1,this.loadImages(),this.$message.success("上传成功")},onPageChange:function(e){this.loadImages(e)},onCollect:function(e){e.loading=!0,he(e.id,!e.is_collected).then((function(t){e.is_collected=!e.is_collected,e.loading=!1}))},onDelete:function(e){var t=this;e.loading=!0,ge(e.id).then((function(a){t.loadImages(),e.loading=!1}))}}},ye=we,Ce=(a("6d1a"),Object(l["a"])(ye,be,ve,!1,null,"0f5e5642",null)),xe=Ce.exports,Se={name:"UploadCover",components:{ImageList:xe},props:["value"],data:function(){return{dialogVisible:!1,activeName:"first"}},computed:{},watch:{},created:function(){},mounted:function(){},beforeDestroy:function(){},methods:{showCoverSelect:function(){this.dialogVisible=!0},handleClick:function(){},onFileChange:function(){var e=this.$refs.file.files[0],t=window.URL.createObjectURL(e);this.$refs["preview-image"].src=t},onCoverConfirm:function(){var e=this;if("second"===this.activeName){var t=this.$refs.file.files[0];if(!t)return void this.$message("请选择图片");var a=new FormData;a.append("image",t),me(a).then((function(t){e.dialogVisible=!1,e.$refs["cover-image"].src=t.data.data.url,e.$emit("input",t.data.data.url)}))}else if("first"===this.activeName){var n=this.$refs["image-list"],o=n.selected;if(null===o)return void this.$message("请选择封面图片");this.dialogVisible=!1,this.$emit("input",n.images[o].url)}}}},$e=Se,ke=(a("17a2"),Object(l["a"])($e,de,pe,!1,null,"1aa7f986",null)),Oe=ke.exports,Ie=a("4ccc");a("7eef");n["default"].use(Ie["f"],{lang:"zh"});var ze={name:"PublishIndex",components:{"el-tiptap":Ie["e"],"upload-cover":Oe},props:{},data:function(){return{extensions:[new Ie["d"],new Ie["u"],new Ie["n"],new Ie["h"]({level:4}),new Ie["a"]({bubble:!0}),new Ie["j"]({uploadRequest:function(e){var t=new FormData;return t.append("image",e),me(t).then((function(e){return e.data.data.url}))}}),new Ie["v"],new Ie["y"]({bubble:!0,menubar:!1}),new Ie["k"],new Ie["p"],new Ie["c"],new Ie["i"],new Ie["s"],new Ie["r"],new Ie["t"],new Ie["q"],new Ie["l"],new Ie["b"],new Ie["m"],new Ie["w"],new Ie["x"],new Ie["g"],new Ie["o"]],article:{title:"",content:"",cover:{type:1,images:[]},channel_id:null},channels:null,formRules:{title:[{required:!0,message:"请输入文章标题",trigger:"blur"},{min:5,max:30,message:"长度在5~30个字符",trigger:"blur"}],content:[{validator:function(e,t,a){"<p></p>"===t?a(new Error("请输入文章内容")):a()}},{required:!0,message:"请输入文章内容",trigger:"blur"}],channel_id:[{required:!0,message:"请选择文章频道"}]}}},computed:{},watch:{},created:function(){this.loadChannels(),this.$route.query.id&&this.loadArticle()},mounted:function(){},methods:{onPublish:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$refs["publish-form"].validate((function(a){if(a){var n=e.$route.query.id;n?A(n,e.article,t).then((function(a){console.log(a),e.$message.success("".concat(t?"存入草稿":"发布","成功"))})):E(e.article,t).then((function(a){console.log(a),e.$message.success("".concat(t?"存入草稿":"发布","成功"))})),e.$router.push("/article")}}))},loadChannels:function(){var e=this;U().then((function(t){var a=t.data.data;e.channels=a.channels}))},loadArticle:function(){var e=this;T(this.$route.query.id.toString()).then((function(t){e.article=t.data.data}))}}},Pe=ze,je=Object(l["a"])(Pe,ce,ue,!1,null,"485948cb",null),De=je.exports,Ue=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"image-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("素材管理")])],1)],1),a("image-list")],1)],1)},Le=[],Ee={name:"ImageIndex",components:{ImageList:xe},props:{},data:function(){return{}},computed:{},watch:{},mounted:function(){},methods:{}},Ae=Ee,Te=Object(l["a"])(Ae,Ue,Le,!1,null,"1d0ffdd9",null),Re=Te.exports,Ve=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"comment-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("评论管理")])],1)],1),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.articles}},[a("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),a("el-table-column",{attrs:{prop:"total_comment_count",label:"总评论数"}}),a("el-table-column",{attrs:{prop:"fans_comment_count",label:"粉丝评论数据"}}),a("el-table-column",{attrs:{label:"评论状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.comment_status?"正常":"关闭")+" ")]}}])}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#ff4949",disabled:t.row.statusDisabled},on:{change:function(a){return e.onStatusChange(t.row)}},model:{value:t.row.comment_status,callback:function(a){e.$set(t.row,"comment_status",a)},expression:"scope.row.comment_status"}})]}}])})],1),a("el-pagination",{staticClass:"pages",attrs:{"current-page":e.page,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount,background:""},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange,"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t}}})],1)],1)},Ne=[],qe={name:"CommentIndex",components:{},props:{},data:function(){return{articles:[],totalCount:0,pageSize:10,page:1}},computed:{},watch:{},created:function(){this.loadArticles()},mounted:function(){},methods:{loadArticles:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,D({response_type:"comment",page:t,per_page:this.pageSize}).then((function(t){var a,n=t.data.data.results,o=Object(_e["a"])(n);try{for(o.s();!(a=o.n()).done;){var i=a.value;i.statusDisabled=!1}}catch(s){o.e(s)}finally{o.f()}e.articles=n,e.totalCount=t.data.data.total_count}))},onStatusChange:function(e){var t=this;e.statusDisabled=!0,R(e.id.toString(),e.comment_status).then((function(a){e.statusDisabled=!1,t.$message.success(e.comment_status?"开启成功":"关闭成功")}))},handleCurrentChange:function(e){this.loadArticles(e)},handleSizeChange:function(){this.loadArticles(1)}}},Me=qe,Be=(a("71b9"),Object(l["a"])(Me,Ve,Ne,!1,null,"1e564d60",null)),Fe=Be.exports,Ge=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"settings-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("个人设置")])],1)],1),a("el-row",[a("el-col",{attrs:{span:16}},[a("el-form",{ref:"form",attrs:{model:e.user,"label-width":"80px",rules:e.formRules}},[a("el-form-item",{attrs:{label:"编号"}},[e._v(" "+e._s(e.user.id)+" ")]),a("el-form-item",{attrs:{label:"手机"}},[e._v(" "+e._s(e.user.mobile)+" ")]),a("el-form-item",{attrs:{label:"媒体名称",prop:"name"}},[a("el-input",{model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),a("el-form-item",{attrs:{label:"媒体介绍",prop:"intro"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.user.intro,callback:function(t){e.$set(e.user,"intro",t)},expression:"user.intro"}})],1),a("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[a("el-input",{model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary",loading:e.updateProfileLoading},on:{click:e.onUpdateUser}},[e._v("保存")])],1)],1)],1),a("el-col",{attrs:{span:6,offset:2}},[a("label",{staticClass:"pointer",attrs:{for:"file"}},[a("el-avatar",{attrs:{shape:"square",size:150,fit:"fit",src:e.user.photo}}),a("p",[e._v("点击修改头像")])],1),a("input",{ref:"file",attrs:{type:"file",id:"file",hidden:""},on:{change:e.onFileChange}})])],1)],1),a("el-dialog",{attrs:{title:"修改头像",visible:e.dialogVisible,"append-to-body":""},on:{"update:visible":function(t){e.dialogVisible=t},opened:e.onDialogOpen,closed:e.onDialogClosed}},[a("div",{staticClass:"preview-image-wrap"},[a("img",{ref:"preview-image",staticClass:"preview-image",attrs:{src:e.previewImage}})]),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary",loading:e.updatePhotoLoading},on:{click:e.onUpdatePhoto}},[e._v("确 定")])],1)])],1)},Je=[],He=(a("ac1f"),a("5319"),a("6107"),a("bab4")),We=a.n(He),Xe={name:"SettingsIndex",components:{},props:{},data:function(){return{user:{email:"",id:null,intro:"",mobile:"",name:"",photo:""},formRules:{name:[{required:!0,message:"请输入名称",trigger:"blur"},{min:1,max:7,message:"长度在1~7个字符",trigger:"blur"}],intro:[{required:!0,message:"不能为空",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]},dialogVisible:!1,previewImage:"",cropper:null,updatePhotoLoading:!1,updateProfileLoading:!1}},computed:{},watch:{},created:function(){this.loadUser()},mounted:function(){},methods:{onUpdateUser:function(){var e=this;this.updateProfileLoading=!0,S(this.user).then((function(t){e.$message.success("保存成功"),e.updateProfileLoading=!1,e.$bus.$emit("updateUser",e.user)}))},loadUser:function(){var e=this;C().then((function(t){e.user=t.data.data}))},onFileChange:function(){var e=this.$refs.file,t=window.URL.createObjectURL(e.files[0]);this.previewImage=t,this.dialogVisible=!0,this.$refs.file.value=""},onDialogOpen:function(){var e=this.$refs["preview-image"];this.cropper?this.cropper.replace(this.previewImage):this.cropper=new We.a(e,{aspectRatio:1,viewMode:1,dragMode:"none",cropBoxResizable:!1,movable:!0})},onDialogClosed:function(){this.cropper.destroy()},onUpdatePhoto:function(){var e=this;this.updatePhotoLoading=!0,this.cropper.getCroppedCanvas().toBlob((function(t){var a=new FormData;a.append("photo",t),x(a).then((function(a){e.dialogVisible=!1,e.user.photo=window.URL.createObjectURL(t),e.updatePhotoLoading=!1,e.$message.success("更新头像成功"),e.$bus.$emit("updateUser",e.user)}))}))}}},Ye=Xe,Ke=(a("a19e"),Object(l["a"])(Ye,Ge,Je,!1,null,"cfc05a70",null)),Qe=Ke.exports,Ze=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"fans-container"},[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("个人设置")])],1)],1),a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"粉丝列表",name:"first"}},[a("el-row",{attrs:{gutter:50}},e._l(e.fans,(function(t,n){return a("el-col",{key:n,staticStyle:{"margin-bottom":"15px"},attrs:{xs:12,sm:8,md:6,lg:4}},[a("el-card",{attrs:{"body-style":e.cardStyle}},[a("img",{staticClass:"image",attrs:{src:t.photo}}),a("div",{staticStyle:{"font-size":"13px"}},[e._v(e._s(t.name))]),a("el-button",{staticClass:"button",attrs:{type:"primary",plain:"",size:"mini"}},[e._v("+关注")])],1)],1)})),1),a("el-pagination",{staticClass:"pages",attrs:{background:"",layout:"total, prev, pager, next",total:e.totalCount,"page-size":e.pageSize,"current-page":e.page},on:{"update:currentPage":function(t){e.page=t},"update:current-page":function(t){e.page=t},"current-change":e.onPageChange}})],1),a("el-tab-pane",{attrs:{label:"粉丝画像",name:"second"}},[a("div",{ref:"main",staticStyle:{width:"600px",height:"400px"}})])],1)],1)],1)},et=[],tt={name:"FansIndex",components:{},props:{},data:function(){return{fans:[],activeName:"first",cardStyle:{height:"230px",padding:"0px 20px 0px",display:"flex","flex-direction":"column","justify-content":"space-around","align-items":"center"},totalCount:0,pageSize:20,page:1}},computed:{},watch:{},created:function(){this.loadFans()},mounted:function(){var e=N.a.init(this.$refs.main),t={title:{text:"粉丝增长详细"},tooltip:{},legend:{data:[]},xAxis:{data:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"]},yAxis:{},series:[{name:"",type:"bar",data:[5,20,36,10,10,20,30]}]};e.setOption(t)},beforeDestroy:function(){},methods:{loadFans:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.page=t,$(t,this.pageSize).then((function(t){e.totalCount=t.data.data.total_count,e.fans=t.data.data.results}))},onPageChange:function(e){this.loadFans(e)}}},at=tt,nt=(a("a2a4"),Object(l["a"])(at,Ze,et,!1,null,"6d4690d3",null)),ot=nt.exports;n["default"].use(d["a"]);var it=[{path:"/login",name:"login",component:z},{path:"/",component:ae,children:[{path:"",name:"home",component:F},{path:"/article",name:"article",component:le},{path:"/publish",name:"publish",component:De},{path:"/image",name:"image",component:Re},{path:"/comment",name:"comment",component:Fe},{path:"/settings",name:"settings",component:Qe},{path:"/fans",name:"fans",component:ot}]}],st=new d["a"]({routes:it});st.beforeEach((function(e,t,a){var n=JSON.parse(window.localStorage.getItem("user"));"/login"!==e.path?n?a():a("/login"):a()}));var rt=st;a("0fae"),a("a4b18");n["default"].use(_.a),n["default"].config.productionTip=!1,new n["default"]({router:rt,render:function(e){return e(u)},beforeCreate:function(){n["default"].prototype.$bus=this}}).$mount("#app")},"63d6":function(e,t,a){"use strict";a("ead5")},"6d1a":function(e,t,a){"use strict";a("8018")},"71b9":function(e,t,a){"use strict";a("12b1")},8018:function(e,t,a){},"8fb9":function(e,t,a){"use strict";a("dd43")},a19e:function(e,t,a){"use strict";a("fe6f")},a22c:function(e,t,a){},a2a4:function(e,t,a){"use strict";a("f0b8")},a4b18:function(e,t,a){},aabf:function(e,t,a){"use strict";a("4f73")},b183:function(e,t,a){},c6eb:function(e,t,a){e.exports=a.p+"img/vue.82b9c7a5.png"},cd6d:function(e,t,a){},dd43:function(e,t,a){},ead5:function(e,t,a){},f0b8:function(e,t,a){},fe6f:function(e,t,a){}});
//# sourceMappingURL=app.b1942348.js.map